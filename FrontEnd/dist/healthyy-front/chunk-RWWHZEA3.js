import{F as k,G as R,H as N,I,L as O,M as Ce,N as B,O as L,P as z,X as T,Y as D,a as S,b as p,d as x,e as M,f as he,g as ve,h as _,k as F,l as w,m as be,n as E,o as y,p as P}from"./chunk-TEVBPT2Y.js";import{b as H,g as ce,h as pe,i as v,j,m as de,o as C,p as fe,q as ge}from"./chunk-PZWSNC3I.js";import"./chunk-Q64FFBLU.js";import{Db as ae,Eb as me,Fb as se,Hb as h,Ja as s,Ka as G,Nb as le,X as re,_a as d,ba as m,cb as f,fa as g,gb as c,hb as t,ib as r,jb as u,kb as ne,nb as b,nc as ue,oa as Z,pa as $,pb as V,rc as q,yb as ie,zb as i}from"./chunk-36BTOISK.js";var U=class n{static \u0275fac=function(o){return new(o||n)};static \u0275cmp=g({type:n,selectors:[["app-auth-layout"]],standalone:!0,features:[h],decls:4,vars:0,template:function(o,a){o&1&&(u(0,"app-navbar-home"),t(1,"div"),u(2,"router-outlet"),r(),u(3,"app-footer"))},dependencies:[fe,ge,pe],styles:[".auth-container[_ngcontent-%COMP%]{display:felx;flex-direction:column;min-height:100vh;justify-content:center;align-items:center;padding:20px}.content-wrapper[_ngcontent-%COMP%]{padding:20px}"]})};function _e(n,e){n&1&&(t(0,"mat-error"),i(1,"Este campo es obligatorio"),r())}function Fe(n,e){n&1&&(t(0,"mat-error"),i(1,"Este campo es obligatorio"),r())}function we(n,e){n&1&&(t(0,"mat-error"),i(1,"La contrase\xF1a debe tener al menos 6 caracteres"),r())}var Y=class n{loginForm;fb=m(E);snackBar=m(T);router=m(v);authService=m(C);constructor(){this.loginForm=this.fb.group({user:["",[p.required]],password:["",[p.required,p.minLength(6)]]})}controlHasError(e,o){return this.loginForm.controls[e].hasError(o)}onSubmit(){if(this.loginForm.invalid)return;let e=this.loginForm.value;this.authService.login(e).subscribe({next:()=>{this.showSnackBar("Inicio de sesion exitoso"),this.router.navigate(["/customer/home"])},error:()=>{this.showSnackBar("Error en el inicio de sesion. Por favor, intenta de nuevo.")}})}showSnackBar(e){this.snackBar.open(e,"Cerrar",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"})}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=g({type:n,selectors:[["app-login"]],standalone:!0,features:[h],decls:29,vars:5,consts:[[1,"login-container"],[1,"login-header"],[1,"login-subtext"],[1,"login-form",3,"ngSubmit","formGroup"],[1,"form-group"],["appearance","outline",1,"form-input"],["matInput","","formControlName","user","placeholder","Introduce tu nombre de usuario"],["matInput","","formControlName","password","type","password","placeholder","Introduce tu contrase\xF1a"],["mat-raised-button","","color","primary","type","submit",1,"submit-button",3,"disabled"],[1,"register-link"],["routerLink","/auth/register"],["routerLink","/auth/recovery"]],template:function(o,a){o&1&&(t(0,"div",0)(1,"h2",1),i(2,"Bienvenido de nuevo"),r(),t(3,"p",2),i(4,"Por favor, inicia sesi\xF3n para continuar"),r(),t(5,"form",3),b("ngSubmit",function(){return a.onSubmit()}),t(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),i(9,"Nombre de usuario"),r(),u(10,"input",6),d(11,_e,2,0,"mat-error"),r()(),t(12,"div",4)(13,"mat-form-field",5)(14,"mat-label"),i(15,"Contrase\xF1a"),r(),u(16,"input",7),d(17,Fe,2,0,"mat-error")(18,we,2,0,"mat-error"),r()(),t(19,"button",8),i(20," Iniciar Sesi\xF3n "),r()(),t(21,"p",9),i(22," \xBFNo tienes cuenta? "),t(23,"a",10),i(24,"Crea una cuenta aqu\xED"),r()(),t(25,"p",9),i(26," \xBFNo tienes cuenta? "),t(27,"a",11),i(28,"\xBFOlvidate tu contrase\xF1a?"),r()()()),o&2&&(s(5),f("formGroup",a.loginForm),s(6),c(a.controlHasError("user","required")?11:-1),s(6),c(a.controlHasError("password","required")?17:-1),s(),c(a.controlHasError("password","minlength")?18:-1),s(),f("disabled",a.loginForm.invalid))},dependencies:[y,_,S,x,M,P,F,w,R,k,L,B,O,N,I,z,D,j],styles:[".login-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;padding:1rem}.login-header[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#333;margin-bottom:.5rem}.login-subtext[_ngcontent-%COMP%]{font-size:1rem;color:#555;margin-bottom:2rem;text-align:center}.login-form[_ngcontent-%COMP%]{background-color:#fff;padding:2rem;border-radius:12px;width:100%;max-width:400px;box-shadow:0 4px 12px #0000001a;transition:transform .3s ease,box-shadow .3s ease}.login-form[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 6px 18px #00000026}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-input[_ngcontent-%COMP%]{width:100%}.submit-button[_ngcontent-%COMP%]{width:100%;padding:.75rem;margin-top:1.5rem;background-color:#28a745;color:#fff;font-weight:700;border-radius:8px;transition:background-color .3s ease,transform .3s ease}.submit-button[_ngcontent-%COMP%]:hover{background-color:#28a745;transform:scale(1.05)}.mat-form-field[_ngcontent-%COMP%]{margin-bottom:1rem}.mat-raised-button[_ngcontent-%COMP%]{font-size:1.1rem;padding:.75rem;border-radius:8px;transition:transform .2s ease,background-color .3s ease}.mat-raised-button[_ngcontent-%COMP%]:hover{transform:scale(1.05);background-color:#218838!important}.register-link[_ngcontent-%COMP%]{text-align:center;margin-top:1.5rem;font-size:.9rem;color:#555}.register-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#007bff;font-weight:700;transition:color .3s ease}.register-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#0056b3;text-decoration:underline}"]})};function Ee(n,e){n&1&&(t(0,"mat-error"),i(1,"Este campo es obligatorio"),r())}function ye(n,e){n&1&&(t(0,"mat-error"),i(1,"Este campo es obligatorio"),r())}function Pe(n,e){n&1&&(t(0,"mat-error"),i(1,"Introduzca un correo electr\xF3nico v\xE1lido."),r())}function ke(n,e){n&1&&(t(0,"mat-error"),i(1,"Este campo es obligatorio"),r())}function Re(n,e){n&1&&(t(0,"mat-error"),i(1,"La contrase\xF1a debe tener al menos 6 caracteres"),r())}var J=class n{registerForm;fb=m(E);snackBar=m(T);authService=m(C);router=m(v);constructor(){this.registerForm=this.fb.group({username:["",[p.required]],email:["",[p.required,p.email]],password:["",[p.required,p.minLength(6)]]})}controlHasError(e,o){return this.registerForm.controls[e].hasError(o)&&this.registerForm.controls[e].touched}onSubmit(){if(this.registerForm.valid){let e=this.registerForm.value;this.authService.register(e).subscribe({next:()=>{this.showSnackBar("Usuario creado correctamente"),this.router.navigate(["/auth/create-profile"])},error:o=>{this.showSnackBar(o.error.message)}})}}showSnackBar(e){this.snackBar.open(e,"Cerrar",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center"})}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=g({type:n,selectors:[["app-register"]],standalone:!0,features:[h],decls:32,vars:7,consts:[[1,"register-container"],[1,"register-header"],[1,"register-subtext"],[1,"register-form",3,"ngSubmit","formGroup"],[1,"form-group"],["appearance","outline",1,"form-input"],["matInput","","formControlName","username","placeholder","Introduce tu nombre"],["matInput","","formControlName","email","placeholder","Introduce tu correo"],["matInput","","formControlName","password","type","password","placeholder","Introduce tu contrase\xF1a"],["mat-raised-button","","color","primary","type","submit",1,"submit-button",3,"disabled"],[1,"login-link"],["routerLink","/auth/login"]],template:function(o,a){o&1&&(t(0,"div",0)(1,"h2",1),i(2,"Crea tu cuenta"),r(),t(3,"p",2),i(4,"Reg\xEDstrate para acceder a la plataforma"),r(),t(5,"form",3),b("ngSubmit",function(){return a.onSubmit()}),t(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),i(9,"Nombre de usuario"),r(),u(10,"input",6),d(11,Ee,2,0,"mat-error"),r()(),t(12,"div",4)(13,"mat-form-field",5)(14,"mat-label"),i(15,"Correo Electr\xF3nico"),r(),u(16,"input",7),d(17,ye,2,0,"mat-error")(18,Pe,2,0,"mat-error"),r()(),t(19,"div",4)(20,"mat-form-field",5)(21,"mat-label"),i(22,"Contrase\xF1a"),r(),u(23,"input",8),d(24,ke,2,0,"mat-error")(25,Re,2,0,"mat-error"),r()(),t(26,"button",9),i(27," Registrarse "),r()(),t(28,"p",10),i(29," \xBFYa tienes una cuenta? "),t(30,"a",11),i(31,"Inicia sesi\xF3n aqu\xED"),r()()()),o&2&&(s(5),f("formGroup",a.registerForm),s(6),c(a.controlHasError("username","required")?11:-1),s(6),c(a.controlHasError("email","required")?17:-1),s(),c(a.controlHasError("email","email")?18:-1),s(6),c(a.controlHasError("password","required")?24:-1),s(),c(a.controlHasError("password","minlength")?25:-1),s(),f("disabled",a.registerForm.invalid))},dependencies:[q,P,_,S,x,M,F,w,Ce,O,N,I,L,B,R,k,D,j],styles:[".register-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;padding:1rem}.register-header[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#333;margin-bottom:.5rem}.register-subtext[_ngcontent-%COMP%]{font-size:1rem;color:#555;margin-bottom:2rem;text-align:center}.register-form[_ngcontent-%COMP%]{background-color:#fff;padding:2rem;border-radius:12px;width:100%;max-width:400px;box-shadow:0 4px 12px #0000001a;transition:transform .3s ease,box-shadow .3s ease}.register-form[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 6px 18px #00000026}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-input[_ngcontent-%COMP%]{width:100%}.submit-button[_ngcontent-%COMP%]{width:100%;padding:.75rem;margin-top:1.5rem;background-color:#28a745;color:#fff;font-weight:700;border-radius:8px;transition:background-color .3s ease,transform .3s ease}.submit-button[_ngcontent-%COMP%]:hover{background-color:#218838;transform:scale(1.05)}.mat-form-field[_ngcontent-%COMP%]{margin-bottom:1rem}.login-link[_ngcontent-%COMP%]{text-align:center;margin-top:1.5rem;font-size:.9rem;color:#555}.login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#007bff;font-weight:700;transition:color .3s ease}.login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#0056b3;text-decoration:underline}"]})};var K=class n{baseURL=`${de.baseURL}/mail`;http=m(H);constructor(){}recovery(e){return this.http.post(`${this.baseURL}/sendMail`,e)}static \u0275fac=function(o){return new(o||n)};static \u0275prov=re({token:n,factory:n.\u0275fac,providedIn:"root"})};function Ne(n,e){n&1&&(t(0,"mat-error"),i(1,"Este campo es obligatorio"),r())}var Q=class n{recoveryForm;fb=m(E);snackBar=m(T);router=m(v);mailService=m(K);constructor(){this.recoveryForm=this.fb.group({user:["",[p.required]]})}controlHasError(e,o){return this.recoveryForm.controls[e].hasError(o)}onSubmit(){if(this.recoveryForm.invalid)return;let e=this.recoveryForm.value.user;this.mailService.recovery(e).subscribe({next:()=>{this.router.navigate(["/home"])},error:()=>{this.showSnackBar("Error en las credenciales")}})}showSnackBar(e){this.snackBar.open(e,"Cerrar",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"})}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=g({type:n,selectors:[["app-recovery"]],standalone:!0,features:[h],decls:18,vars:3,consts:[[1,"login-container"],[1,"login-header"],[1,"login-subtext"],[1,"login-form",3,"ngSubmit","formGroup"],[1,"form-group"],["appearance","outline",1,"form-input"],["matInput","","formControlName","user","placeholder","Introduce gmail"],["mat-raised-button","","color","primary","type","submit",1,"submit-button",3,"disabled"],[1,"register-link"],["routerLink","/auth/register"]],template:function(o,a){o&1&&(t(0,"div",0)(1,"h2",1),i(2,"Bienvenido de nuevo"),r(),t(3,"p",2),i(4,"Por favor, inicia sesi\xF3n para continuar"),r(),t(5,"form",3),b("ngSubmit",function(){return a.onSubmit()}),t(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),i(9,"Correo electronico"),r(),u(10,"input",6),d(11,Ne,2,0,"mat-error"),r()(),t(12,"button",7),i(13," Enviar "),r()(),t(14,"p",8),i(15," \xBFNo tienes cuenta? "),t(16,"a",9),i(17,"Crea una cuenta aqu\xED"),r()()()),o&2&&(s(5),f("formGroup",a.recoveryForm),s(6),c(a.controlHasError("user","required")?11:-1),s(),f("disabled",a.recoveryForm.invalid))},dependencies:[y,_,S,x,M,P,F,w,R,k,L,B,O,N,I,z,D]})};var te=(n,e)=>{let o=m(C),a=m(v);if(o.isAuthenticated()){let l=o.getUserRole();return l==="ADMIN"?a.navigate(["/admin"]):l==="USER"&&a.navigate(["/customer/home"]),!1}return!0};function Ie(n,e){if(n&1){let o=ne();t(0,"div")(1,"h2"),i(2,"Restablecer Contrase\xF1a"),r(),t(3,"form",2),b("ngSubmit",function(){Z(o);let l=V();return $(l.submitNewPassword())}),t(4,"label",3),i(5,"Nueva Contrase\xF1a"),r(),t(6,"input",4),se("ngModelChange",function(l){Z(o);let oe=V();return me(oe.newPassword,l)||(oe.newPassword=l),$(l)}),r(),t(7,"button",5),i(8,"Restablecer Contrase\xF1a"),r()()()}if(n&2){let o=V();s(6),ae("ngModel",o.newPassword)}}function Oe(n,e){n&1&&(t(0,"p"),i(1,"El token no es v\xE1lido o ha expirado. Por favor, solicite uno nuevo."),r())}var X=class n{constructor(e,o,a){this.route=e;this.http=o;this.router=a}token="";authService=m(C);isTokenValid=!1;newPassword="";ngOnInit(){this.token=this.route.snapshot.paramMap.get("token")||"",console.log("Token recibido:",this.token),this.token&&this.verifyToken(this.token)}verifyToken(e){this.authService.checkToken(e).subscribe(o=>{o===!1?(this.router.navigate(["/auth/login"]),alert("Token expirado")):this.isTokenValid=!0},o=>{alert("Error al verificar el token"),this.router.navigate(["/auth/login"])})}submitNewPassword(){if(!this.newPassword){alert("Por favor ingresa una nueva contrase\xF1a.");return}this.authService.resetPassword(this.token,this.newPassword).subscribe(e=>{alert("Contrase\xF1a restablecida con \xE9xito."),this.router.navigate(["/auth/login"])},e=>{alert("Error al restablecer la contrase\xF1a")})}static \u0275fac=function(o){return new(o||n)(G(ce),G(H),G(v))};static \u0275cmp=g({type:n,selectors:[["app-forgot-password"]],standalone:!0,features:[h],decls:3,vars:2,consts:[["tokenInvalid",""],[4,"ngIf","ngIfElse"],[3,"ngSubmit"],["for","newPassword"],["type","password","id","newPassword","name","newPassword","required","",3,"ngModelChange","ngModel"],["type","submit"]],template:function(o,a){if(o&1&&d(0,Ie,9,1,"div",1)(1,Oe,2,0,"ng-template",null,0,le),o&2){let l=ie(2);f("ngIf",a.isTokenValid)("ngIfElse",l)}},dependencies:[q,ue,y,_,S,x,M,be,ve,he]})};var zt=[{path:"",component:U,children:[{path:"login",component:Y,canActivate:[te]},{path:"register",component:J,canActivate:[te]},{path:"recovery",component:Q},{path:"forgot/:token",component:X}]}];export{zt as authRoutes};
